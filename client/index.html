<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.plot.ly/plotly-2.14.0.min.js"></script>

    <script data-trunk src="/assets/mermaid.min.js"></script>
    <link data-trunk rel="inline" type="js" href="/assets/mermaid_config.js"/>

    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"></script>

    <script src="https://cdn.jsdelivr.net/npm/apache-arrow@8.0.0/umd/Arrow.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.2.4/dist/plot.umd.min.js"></script> -->

    <script src="https://d3js.org/d3.v7.min.js"></script>

    <link data-trunk rel="rust" data-wasm-opt="z" />
    <link data-trunk rel="css" href="assets/demo.css" />
    <link data-trunk rel="css" href="assets/demo-normalise.css" />
    <!-- <link data-trunk rel="rust" data-wasm-opt="4" data-weak-refs data-reference-types/> -->
    <base data-trunk-public-url/>


</head>

<body>
    <div id="plot-container"></div>
    <!-- <div id="plot"></div> -->
    <script>


        // const ws = new WebSocket('ws://localhost:5000/ws/');

        // ws.binaryType = 'arraybuffer';

        // ws.onmessage = async (event) => {
        //     if (typeof event.data === 'string') {
        //         console.log('Received text message:', event.data);
        //     } else {
        //         const buffer = new Uint8Array(event.data);
        //         const table = arrow.tableFromIPC(buffer);

        //         const columnA = table.getColumn('a').toArray();
        //         const columnB = table.getColumn('b').toArray();

        //         const data = columnA.map((a, index) => ({
        //             a,
        //             b: columnB[index]
        //         }));

        //         const plot = Plot.plot({
        //             marks: [
        //                 Plot.line(data, { x: 'a', y: 'b' })
        //             ],
        //             x: { label: "Column A" },
        //             y: { label: "Column B" }
        //         });

        //         document.getElementById('plot-container').innerHTML = '';
        //         document.getElementById('plot-container').appendChild(plot);

        //     } //on message
        // };

        // ws.onopen = () => {
        //     ws.send('Requesting data');
        // };






        // const data = [
        // {date: new Date(2023, 0, 1), value: 100},
        // {date: new Date(2023, 0, 2), value: 110},
        // // more data points...
        // ];

        // const plot = Plot.plot({
        // marks: [
        // Plot.ruleY([0]),
        // Plot.lineY(data, {x: "date", y: "value"}),
        // (index, scales, channels, dimensions, context) => {
        //     const x1 = dimensions.marginLeft;
        //     const x2 = dimensions.width - dimensions.marginRight;
        //     const y1 = 0;
        //     const y2 = dimensions.height;
        //     const brushed = (event) => setStartEnd(event.selection?.map(scales.x.invert));
        //     const brush = d3.brushX().extent([[x1, y1], [x2, y2]]).on("brush end", brushed);
        //     return d3.create("svg:g").call(brush).node();
        //     }
        // ]
        // });
        // document.getElementById("plot-container").appendChild(plot);
    </script>
</body>

</html>
